const {HOOKS: {EXTRACT_PROCESS}} = require('../../../../src/addon/index');

exports[EXTRACT_PROCESS] = function extractProcess() {
  return (extracted, operation) => {
    extracted.process = extracted.process.map(process => {
      if (process.processor === 'sharp') {
        const initialPipeFunction = process.pipe;
        process.pipe = function(pipe) {
          pipe = initialPipeFunction(pipe);
          return pipe.toFormat('webp');
        };
      }
      return process;
    });
    return extracted;
  };
};
